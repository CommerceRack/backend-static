var myRIA=function(){var r={vars:{"templates":['productTemplate','mpControlSpec','categoryTemplate','categoryPageTemplate','prodViewerTemplate','cartViewer','cartViewerProductTemplate','prodReviewSummaryTemplate','productChildrenTemplate','prodReviewsTemplate','reviewFrmTemplate','subscribeFormTemplate','categoryThumbTemplate','orderLineItemTemplate','orderContentsTemplate','cartSummaryTemplate','orderProductLineItemTemplate','helpTemplate','customerTemplate','homepageTemplate','searchTemplate','prodHPFeaturedTemplate','faqTopicTemplate','faqQnATemplate','catPageHeaderTemplate','catPageFooterTemplate','prodHPBestTemplate','billAddressTemplate','shipAddressTemplate'],"user":{"recentSearches":[],"recentlyViewedItems":[]},"dependAttempts":0,"dependencies":['store_prodlist','store_navcats','store_product','store_search','store_cart','store_crm','convertSessionToOrder']},calls:{buyerAddressList:{init:function(tagObj,Q){tagObj=$.isEmptyObject(tagObj)?{}:tagObj;tagObj["datapointer"]="buyerAddressList";this.dispatch(tagObj,Q);return 1;},dispatch:function(tagObj,Q){myControl.model.addDispatchToQ({"_cmd":"buyerAddressList","_tag":tagObj},Q);}},},callbacks:{init:{onSuccess:function(){var r=true;return r;},onError:function(){myControl.util.dump('BEGIN myControl.ext.myRIA.callbacks.init.onError');}},startMyProgram:{onSuccess:function(){window.onpopstate=function(event){myControl.ext.myRIA.util.handlePopState(event.state);};myControl.ext.store_navcats.calls.appCategoryList.init();var page=myControl.ext.myRIA.util.handleLegacyURL();myControl.calls.appProfileInfo.init(myControl.vars.profile,{});if(page.pageType=='cart'||page.pageType=='checkout'){}
else{myControl.calls.refreshCart.init({'callback':'updateMCLineItems','extension':'myRIA'},'mutable');myControl.ext.store_cart.calls.cartShippingMethods.init({},'mutable');}
myControl.model.dispatchThis();myControl.ext.store_navcats.calls.appPageGet.init({'PATH':'.100__satisfaction_guarantee','@get':['description']},'passive');myControl.ext.store_navcats.calls.appCategoryDetail.init('$best_sellers',{},'passive');myControl.model.dispatchThis('passive');if($('#headerCatalog').val()!=''){myControl.ext.store_search.util.bindKeywordAutoComplete('headerSearchFrm');}
$('#headerSearchFrm').submit(function(){myControl.ext.myRIA.util.changeNavTo('search');myControl.ext.store_search.calls.searchResult.init($(this).serializeJSON(),{'callback':'showResults','extension':'myRIA'});myControl.model.dispatchThis();return false;});$('#headerSearchFrmSubmit').removeAttr('disabled');$('#cartBtn').removeAttr('disabled');},onError:function(d){$('#globalMessaging').append(myControl.util.getResponseErrors(d)).toggle(true);}},displayXsell:{onSuccess:function(tagObj){myControl.util.dump("BEGIN myRIA.callbacks.displayXsell.onSuccess");var data=myControl.data[tagObj.datapointer];if(data['%attribs']['zoovy:grp_children']){myControl.ext.store_prodlist.util.buildProductList({"templateID":"productChildrenTemplate","withInventory":1,"withVariations":1,"parentID":"prodlistChildren","csv":data['%attribs']['zoovy:grp_children']});}
if(data['%attribs']['zoovy:related_products']){$('#prodlistRelatedContainer').show();var numRequests=myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":"prodlistRelated","items_per_page":100,"csv":data['%attribs']['zoovy:related_products']});}
else{$('#prodlistRelatedContainer').empty().remove();}
if(data['%attribs']['zoovy:accessory_products']){$('#prodlistAccessoriesContainer').show();myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":"prodlistAccessories","csv":data['%attribs']['zoovy:accessory_products']});}
else{$('#prodlistAccessoriesContainer').empty().remove();}
myControl.ext.store_product.util.showReviewSummary({"pid":data.pid,"templateID":"prodReviewSummaryTemplate","parentID":"prodViewerReviewSummary"});myControl.ext.store_product.util.showReviews({"pid":data.pid,"templateID":"prodReviewsTemplate","parentID":"prodViewerReviews"});myControl.model.dispatchThis();},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},itemAddedToCart:{onSuccess:function(tagObj){myControl.util.dump('BEGIN myControl.ext.store_product.callbacks.itemAddedToCart.onSuccess');$('.atcButton').removeAttr('disabled').removeClass('disabled');var htmlid='atcMessaging_'+myControl.data[tagObj.datapointer].product1;$('#atcMessaging_'+myControl.data[tagObj.datapointer].product1).append(myControl.util.formatMessage({'message':'Item Added','htmlid':htmlid,'uiIcon':'check','timeoutFunction':"$('#"+htmlid+"').slideUp(1000);"}));},onError:function(responseData,uuid){myControl.util.dump('BEGIN myControl.ext.store_product.callbacks.init.onError');$('.atcButton').removeAttr('disabled');$('#atcMessaging_'+myControl.data[responseData['_rtag'].datapointer].product1).append(myControl.util.getResponseErrors(responseData))}},updateMCLineItems:{onSuccess:function(tagObj){var itemCount=myControl.util.isSet(myControl.data[tagObj.datapointer].cart['data.item_count'])?myControl.data[tagObj.datapointer].cart['data.item_count']:myControl.data[tagObj.datapointer].cart['data.add_item_count']
$('.itemCount').text(itemCount);},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},showProd:{onSuccess:function(tagObj){myControl.renderFunctions.translateTemplate(myControl.data[tagObj.datapointer],tagObj.parentID);var pid=myControl.data[tagObj.datapointer].pid;$("#tabbedProductContent").tabs();var numRequests=myControl.ext.store_product.util.getXsellForPID(pid,'mutable');myControl.util.dump(" -> numRequest for xsell product inf: "+numRequests);var pingTagObj={"callback":"displayXsell","extension":"myRIA","datapointer":tagObj.datapointer}
if(numRequests>0){myControl.calls.ping.init(pingTagObj);myControl.model.dispatchThis();}
else{myControl.util.handleCallback(pingTagObj)}
var url=window.location.protocol+'//'+myControl.vars.sdomain+myControl.ext.myRIA.util.buildRelativePath({"pageType":"product","pageInfo":pid});if(typeof addthis_share=='object'){addthis_share.url=url;}
if(typeof addthis=='object'){$('#prodViewerAddThis').empty().html("<a class='addthis_button_facebook_like'></a><a class='addthis_button_tweet' tw:count='horizontal'></a><a class='addthis_button_google_plusone'></a><a class='addthis_button_compact'></a><a class='addthis_counter addthis_bubble_style'></a>");addthis.toolbox('#prodViewerAddThis','',{"url":url});}
myControl.util.jumpToAnchor('top');},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},showAddresses:{onSuccess:function(tagObj){myControl.util.dump("BEGIN myRIA.callbacks.showAddresses.onSuccess");var authState=myControl.sharedCheckoutUtilities.determineAuthentication();var $buyerAddresses=$('#buyerAddresses').empty();if(authState=='authenticated'){var types=new Array('@ship','@bill');var L,type;for(var j=0;j<2;j+=1){type=types[j];L=myControl.data.buyerAddressList[type].length;if(L){$buyerAddresses.append(type=='@bill'?'<h2>billing address(es)</h2>':'<h2>shipping address(es)</h2>');}
for(var i=0;i<L;i+=1){$buyerAddresses.append(myControl.renderFunctions.transmogrify({'id':'address_'+myControl.data.buyerAddressList[type][i]['_id'],'addressclass':type,'addressid':myControl.data.buyerAddressList[type][i]['_id']},type.substring(1)+'AddressTemplate',myControl.data.buyerAddressList[type][i]))}}}},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},cartUpdated:{onSuccess:function(tagObj){myControl.util.dump("BEGIN myRIA.callbacks.cartUpdated.onSuccess");myControl.ext.store_cart.util.showCartInModal();},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},showPageContent:{onSuccess:function(tagObj){var catSafeID=tagObj.datapointer.split('|')[1];myControl.renderFunctions.translateTemplate(myControl.data['appCategoryDetail|'+catSafeID],'page-'+catSafeID);if(typeof myControl.data['appCategoryDetail|'+catSafeID]['@subcategoryDetail']=='object'){var subcatTemplateID='categoryThumbTemplate';myControl.ext.store_navcats.util.getChildDataOf(catSafeID,{'parentID':'subcategoryListContainer','callback':'addCatToDom','templateID':subcatTemplateID,'extension':'store_navcats'},'appCategoryDetailMax');}
else{}
myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":"productListContainer","items_per_page":20,"csv":myControl.data[tagObj.datapointer]['@products']});myControl.model.dispatchThis();if(catSafeID!='.'){myControl.ext.myRIA.util.breadcrumb(catSafeID)}
$('#mainContentArea').removeClass('loadingBG');myControl.util.jumpToAnchor('top');},onError:function(d){$('#mainContentArea').removeClass('loadingBG').append(myControl.util.getResponseErrors(d)).toggle(true);}},showList:{onSuccess:function(tagObj){myControl.util.dump('BEGIN myControl.ext.myRIA.showList.onSuccess ');var listID=tagObj.datapointer.split('|')[1];var prods=myControl.ext.store_crm.util.getSkusFromList(listID);if(prods.length<1){myControl.util.formatMessage('This list ('+listID+') appears to be empty.');}
else{myControl.util.dump(prods);myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":tagObj.parentID,"csv":prods})
myControl.model.dispatchThis();}},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},showProdList:{onSuccess:function(tagObj){if(myControl.data[tagObj.datapointer]['@products'].length<1){$('#'+tagObj.targetID).append(myControl.util.formatMessage('This list ('+listID+') appears to be empty.'));}
else{myControl.ext.store_prodlist.util.buildProductList({"templateID":tagObj.templateID,"parentID":tagObj.targetID,"csv":myControl.data[tagObj.datapointer]['@products']})
myControl.model.dispatchThis();}},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}},authenticateThirdParty:{onSuccess:function(tagObj){},onError:function(responseData){myControl.util.dump('BEGIN myControl.callbacks.authenticateThirdParty.onError');$('#globalMessaging').append(myControl.util.getResponseErrors(responseData)).toggle(true);}},authenticateZoovyUser:{onSuccess:function(tagObj){myControl.util.dump('BEGIN myRIA.callbacks.authenticateZoovyUser.onSuccess');myControl.vars.cid=myControl.data[tagObj.datapointer].cid;$('#loginSuccessContainer').show();$('#loginMessaging').empty().show().append("Thank you, you are now logged in.");$('#loginFormContainer').hide();},onError:function(responseData,uuid){$("#loginMessaging").append(myControl.util.getResponseErrors(responseData)).toggle(true)
}},updateSearchNav:{onSuccess:function(tagObj){var keyword=tagObj.datapointer.split("|")[1];var o="<li><a href='#' onClick=\"$('#headerKeywordsInput').val('"+keyword+"'); $('#headerSearchFrm').submit();\">"+keyword+" ("+myControl.data[tagObj.datapointer]['@products'].length+")<\/a><\/li>"
$('#altSearchesList').removeClass('loadingBG').append(o);},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid);$('#altSearchesList').removeClass('loadingBG')}},showResults:{onSuccess:function(tagObj){var keywords=tagObj.datapointer.split('|')[1];if($.inArray(keywords,myControl.ext.myRIA.vars.user.recentSearches)<0)
myControl.ext.myRIA.vars.user.recentSearches.push(keywords);$('#altSearchesList').empty();if(myControl.data[tagObj.datapointer]['@products'].length==0){$('#resultsProdlist').empty().append("Zero items matched your search.  Please try again.");}
else{myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":"resultsProductListContainer","items_per_page":20,"csv":myControl.data[tagObj.datapointer]['@products']})}
var keywords=tagObj.datapointer.split('|')[1];if(keywords.split(' ').length>1){$('#altSearchesContainer').show();$('#altSearchesList').addClass('loadingBG');myControl.ext.store_search.util.getAlternativeQueries(keywords,{"callback":"updateSearchNav","extension":"myRIA"});}
else{$('#altSearchesContainer').hide();}
myControl.ext.myRIA.util.showRecentSearches();myControl.model.dispatchThis();},onError:function(responseData,uuid){myControl.util.handleErrors(responseData,uuid)}}},wiki:{":search":function(suffix,phrase){return"<a href='#' onClick=\"$('#headerKeywordsInput').val('"+suffix+"'); $('#headerSearchFrm').submit(); return false; \">"+phrase+"<\/a>"},":category":function(suffix,phrase){return"<a href='#' onClick='myControl.ext.myRIA.util.handlePageContent(\"category\",\""+suffix+"\"); return false;'>"+phrase+"<\/a>"},":product":function(suffix,phrase){return"<a href='#' onClick='myControl.ext.myRIA.util.handlePageContent(\"product\",\""+suffix+"\"); return false;'>"+phrase+"<\/a>"},":customer":function(suffix,phrase){return"<a href='#' onClick='myControl.ext.myRIA.util.changeNavTo(\"customer\"); return false;'>"+phrase+"<\/a>"}},renderFormats:{subcatList:function($tag,data){var catSafeID;var o='';if(!$.isEmptyObject(myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'])){var L=myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'].length;var size=L>3?3:L;for(var i=0;i<size;i+=1){if(myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'][i].pretty[0]!='!'){catSafeID=myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'][i].id;o+="<li onClick=\"myControl.ext.myRIA.util.handlePageContent('category','"+catSafeID+"');\"> &#187; "+myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'][i].pretty;if(myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'][i]['@products'].length>0)
o+=" ("+myControl.data['appCategoryDetail|'+data.bindData.cleanValue]['@subcategoryDetail'][i]['@products'].length+" items)"
o+="<\/li>";}}
if(L>3){o+="<li onClick=\"myControl.ext.myRIA.util.handlePageContent('category','"+data.bindData.cleanValue+"');\">&#187; <b> View all "+L+" Categories<\/b><\/li>";}
$tag.append(o);}},paypalButtonHack:function($tag,data){$tag.empty().append("<a href='https://secure.homebrewers.com/c="+myControl.sessionId+"/s=homebrewers.com/paypal.cgis?mode=cartec&cart="+myControl.sessionId+"&ts='"+myControl.util.unixNow()+"><img width='145' height='42' border='0' src='https://www.paypal.com/en_US/i/btn/btn_xpressCheckoutsm.gif' alt='' /></a>");},googleButtonHack:function($tag,data){$tag.empty().append("<a href=\"javascript:setUrchinInputCode(pageTracker); document.location='https://secure.homebrewers.com/c="+myControl.sessionId+"/s=homebrewers.com/_googlecheckout?analyticsdata='+getUrchinFieldValue();\"><img height=43 width=160 border=0 src='https://checkout.google.com/buttons/checkout.gif?merchant_id=826419156185928&w=160&h=43&style=white&variant=text&loc=en_US'></a>");},legacyURLToRIA:function($tag,data){myControl.util.dump("BEGIN control.renderFormats.legacyURLToRIA");myControl.util.dump(" -> data.bindData.cleanValue: "+data.bindData.cleanValue);if(data.bindData.cleanValue=='#'){$tag.removeClass('pointer');}
else{pageType=myControl.ext.myRIA.util.whatPageTypeAmI(data.bindData.cleanValue);pageInfo=myControl.ext.myRIA.util.giveMeRelevantInfoToPage(data.bindData.cleanValue);myControl.util.dump(" -> pageType: "+pageType);myControl.util.dump(" -> pageInfo: "+pageInfo);$tag.addClass('pointer').click(function(){myControl.ext.myRIA.util.handlePageContent(pageType,pageInfo,true);});}},priceRetailSavings:function($tag,data){var o='';var pData=myControl.data['appProductGet|'+data.bindData.cleanValue]['%attribs'];var price=parseInt(pData['zoovy:base_price']);var msrp=parseInt(pData['zoovy:prod_msrp']);if(price>0){o+="<div class='basePrice'><span class='prompt pricePrompt'>Our Price: <\/span><span class='value'>";o+=myControl.util.formatMoney(pData['zoovy:base_price'],'$',2,true)
o+="<\/span><\/div>";if(msrp>price){o+="<div class='retailPrice'><span class='prompt retailPricePrompt'>MSRP: <\/span><span class='value'>";o+=myControl.util.formatMoney(pData['zoovy:prod_msrp'],'$',2,true)
o+="<\/span><\/div>";if(msrp-price>1){o+="<div class='savings'><span class='prompt savingsPrompt'>You Save: <\/span><span class='value'>";o+=myControl.util.formatMoney(msrp-price,'$',2,true)
o+="<\/span><\/div>";}}}
$tag.append(o);}},util:{guessContainerParentCat:function(pid){var r,org;org=myControl.data['appProductGet|'+pid]['%attribs']['user:prod_organization']
if(org){if(org=='MLB'){r='.storage-containers.major-league-baseball'}
else if(org=='NFL'){r='.storage-containers.national-football-league'}
else{r=false}}
else{r=false;}
return r;},handleLegacyURL:function(){var pageType=this.whatPageTypeAmI(window.location.href);var pageInfo=this.giveMeRelevantInfoToPage(window.location.href);this.handlePageContent(pageType,pageInfo,false);return{'pageType':pageType,'pageInfo':pageInfo}},handlePageContent:function(pageType,pageInfo,skipPushState){$(".ui-dialog-content").dialog("close");switch(pageType){case'product':myControl.ext.myRIA.util.showProd(pageInfo);break;case'category':myControl.ext.myRIA.util.showPage(pageInfo);break;case'customer':myControl.ext.myRIA.util.changeNavTo('customer',pageInfo);break;case'checkout':myControl.util.dump("PROTOCOL: "+document.location.protocol);if('https:'!=document.location.protocol){document.location=myControl.vars.secureURL+"c="+myControl.sessionId+"/checkout.cgis?SENDER=JCHECKOUT&SKIPPUSHSTATE=1&WRAPPER=~homebrewer_homebrewerscom_20120323";}
else{if(myControl.util.getParameterByName('SKIPPUSHSTATE')==1)
skipPushState=true;$('#mainContentArea').empty();myControl.ext.convertSessionToOrder.calls.startCheckout.init('mainContentArea');}
break;case'help':myControl.ext.myRIA.util.changeNavTo('help',pageInfo);break;case'homepage':myControl.ext.myRIA.util.showPage('.');break;case'cart':myControl.ext.myRIA.util.showPage('.');myControl.ext.myRIA.util.showCart();break;default:myControl.ext.myRIA.util.showPage('.');}
if(skipPushState==true){myControl.util.dump("skipped adding a pushstate for "+pageType);}
else{this.addPushState({'pageType':pageType,'pageInfo':pageInfo})}},whatPageTypeAmI:function(url){var r;if(!url){myControl.util.dump("no url specified for whatPageTypeAmI");}
else if(url.indexOf('/product/')>0){r='product'}
else if(url.indexOf('/category/')>0){r='category'}
else if(url.indexOf('/customer/')>0){r='customer'}
else if(url.indexOf('/cart')>0){r='cart'}
else if(url.indexOf('/checkout')>0){r='checkout'}
else{r='other'}
myControl.util.dump("whatPageTypeAmI = "+r);return r;},giveMeRelevantInfoToPage:function(url){var r;if(url.indexOf('#')>0){url=url.substr(0,url.indexOf('#'));}
url=url.split('?')[0]
if(url.indexOf('/product/')>0){r=url.split('/product/')[1];if(r.indexOf('/')>0){r=r.split('/')[0];}}
else if(url.indexOf('/category/')>0){r=url.split('/category/')[1];myControl.util.dump(" after /category/ split, r = "+r);if(r.charAt(r.length-1)=='/'){r=r.slice(0,-1)}
myControl.util.dump(" after strip trailing slash, r = "+r);if(r.charAt(0)!='.'){r='.'+r}}
else if(url.indexOf('/customer/')>0){r=url.split('/customer/')[1];if(r.charAt(r.length-1)=='/'){r=r.slice(0,-1)}}
else{var chunks=url.split('/');r=chunks[chunks.length-1];if(r.indexOf('?')>0){r=r.split('?')[1]}
r=r.replace('.cgis');}
return r;},whatAmIFor:function(P){var r=false;if(P.pid){r='product'}
else if(P.catSafeID){r='category'}
else if(P.path){r='category'}
else if(P.page&&P.page.indexOf('/customer/')>0){r='customer'}
else if(P.page){r='help'}
return r;},handlePopState:function(P){if(P){this.handlePageContent(P.pageType,P.pageInfo,true);}
else{}},addPushState:function(P){var title='HomeBrewers '+P.pageInfo;var relativePath;if(P.pageInfo=='.'){P.pageType='other'
relativePath='/';}
else{relativePath=this.buildRelativePath(P);}
try{window.history.pushState(P,title,relativePath);}
catch(err){}},buildRelativePath:function(P){var relativePath;switch(P.pageType){case'product':relativePath='/product/'+P.pageInfo+'/';break;case'category':var noPrePeriod=P.pageInfo.charAt(0)=='.'?P.pageInfo.substr(1):P.pageInfo;relativePath='/category/'+noPrePeriod+'/';break;case'customer':relativePath='/customer/'+P.pageInfo+'/';break;case'other':relativePath='/'+P.pageInfo;break;default:relativePath='/'+P.pageInfo;}
return relativePath;},showProd:function(pid){$('#globalMessaging').empty().hide();$('#mainContentArea').empty().append(myControl.renderFunctions.createTemplateInstance('prodViewerTemplate',"productViewer"));myControl.ext.store_product.calls.appReviewsList.init(pid);myControl.ext.store_product.calls.appProductGet.init(pid,{'callback':'showProd','extension':'myRIA','parentID':'productViewer'});myControl.model.dispatchThis();if($.inArray(pid,myControl.ext.myRIA.vars.user.recentlyViewedItems)<0)
myControl.ext.myRIA.vars.user.recentlyViewedItems.push(pid);},changeNavTo:function(newNav,article){$(".ui-dialog-content").dialog("close");if(!newNav){myControl.util.dump("WARNING - nav type not specified for changeNavTo");}
else if(newNav=='search'){$('#mainContentArea').empty().append(myControl.renderFunctions.transmogrify('mainContentArea_'+newNav,newNav+'Template',myControl.data['appProfileInfo|'+myControl.vars.profile]))}
else if(newNav=='help'||newNav=='customer'){$('#mainContentArea').empty().append(myControl.renderFunctions.transmogrify('mainContentArea_'+newNav,newNav+'Template',myControl.data['appProfileInfo|'+myControl.vars.profile]))}
else{myControl.util.dump("WARNING - unknown nav type ["+newNav+"] specified for changeNavTo");}
myControl.ext.myRIA.util.bindNav(newNav);if(article)
this.showArticle(article);},whichNavIsVisible:function(){var r='';$('#rightCol nav').each(function(){if($(this).is(':visible')){r=$(this).attr('id');r=r.slice(0,r.length-3);}});return r;},bindNav:function(newNav){$('#rightCol nav a').each(function(){var $this=$(this);$this.addClass('ui-state-default').click(function(event){$('#rightCol nav a').removeClass('ui-state-active');event.preventDefault();myControl.ext.myRIA.util.handlePageContent(newNav,$this.attr('href').substring(1))});});},showPriceMatching:function(){var $target=$('#priceMatching');$target.empty().append(myControl.renderFunctions.transmogrify('priceMatchingContent','catPageHeaderTemplate',myControl.data['appPageGet|.100__satisfaction_guarantee']['%page']))
$target.dialog({modal:true,width:600,height:600});},showLoginModal:function(){$('#loginSuccessContainer').hide();$('#loginMessaging').empty();$('#loginFormContainer').show();$('#loginFormForModal').dialog({modal:true,width:400});},showArticle:function(subject){$('#mainContentArea article').hide();$('#rightCol [href=#'+subject+']').addClass('ui-state-highlight');$('#globalMessaging').empty();var authState=myControl.sharedCheckoutUtilities.determineAuthentication();myControl.util.dump(" -> authState = "+authState);if((authState!='authenticated')&&(subject=='orders'||subject=='wishlist'||subject=='changepassword'||subject=='forgetme'||subject=='myaccount')){myControl.ext.myRIA.util.showLoginModal();$('#loginSuccessContainer').empty();$('<button>').addClass('stdMargin ui-state-default ui-corner-all  ui-state-active').attr('id','modalLoginContinueButton').text('Continue').click(function(){$('#loginFormForModal').dialog('close');myControl.ext.myRIA.util.showArticle(subject)}).appendTo($('#loginSuccessContainer'));}
else{$('#'+subject+'Article').show();switch(subject){case'newsletter':$('#newsletterFormContainer').empty();myControl.ext.store_crm.util.showSubscribe({'parentID':'newsletterFormContainer','templateID':'subscribeFormTemplate'});break;case'orders':myControl.ext.store_crm.calls.buyerPurchaseHistory.init({'parentID':'orderHistoryContainer','templateID':'orderLineItemTemplate','callback':'showOrderHistory','extension':'store_crm'});break;case'wishlist':myControl.ext.store_crm.calls.buyerProductLists.init('wishlist',{'parentID':'wishlistContainer','callback':'showList','extension':'myRIA'});break;case'myaccount':myControl.ext.myRIA.calls.buyerAddressList.init({'callback':'showAddresses','extension':'myRIA'},'mutable');break;case'faq':myControl.ext.store_crm.calls.appFAQsAll.init({'parentID':'faqContent','callback':'showFAQTopics','extension':'store_crm','templateID':'faqTopicTemplate'});break;case'forgetme':myControl.ext.store_crm.calls.buyerProductLists.init('forgetme',{'parentID':'forgetmeContainer','callback':'showList','extension':'myRIA'});break;default:}}
myControl.model.dispatchThis();},showRecentSearches:function(){var o='';var L=myControl.ext.myRIA.vars.user.recentSearches.length;var keywords,count;for(i=0;i<L;i++){keywords=myControl.ext.myRIA.vars.user.recentSearches[i];count=$.isEmptyObject(myControl.data['searchResult|'+keywords])?0:myControl.data['searchResult|'+keywords]['@products'].length
o+="<li><a href='#' onClick=\"$('#headerKeywordsInput').val('"+keywords+"'); $('#headerSearchFrm').submit(); return false;\">"+keywords+" ("+count+")<\/a><\/li>";}
$('#recentSearchesList').html(o);},breadcrumb:function(catSafeID){if(catSafeID=='.'){}
else{var pathArray=catSafeID.split('.');var $bc=$('#breadcrumb');var len=pathArray.length-1;var s='.';var numRequests=0;$bc.append(myControl.renderFunctions.createTemplateInstance('categoryTemplate','breadcrumb_homepage'));numRequests+=myControl.ext.store_navcats.calls.appCategoryDetail.init(s,{"callback":"translateTemplate","parentID":'breadcrumb_homepage'});for(var i=1;i<len;i+=1){s+=pathArray[i];$bc.append(myControl.renderFunctions.createTemplateInstance('categoryTemplate','breadcrumb_'+s));numRequests+=myControl.ext.store_navcats.calls.appCategoryDetail.init(s,{"callback":"translateTemplate","parentID":'breadcrumb_'+s});s+=".";}
if(numRequests>0){myControl.model.dispatchThis()}}},showPage:function(catSafeID){$(".ui-dialog-content").dialog("close");if(catSafeID=='.'){$('#mainContentArea').empty().append(myControl.renderFunctions.transmogrify('homepage','homepageTemplate',{}));myControl.ext.store_prodlist.vars.featuredItemsHP={};myControl.ext.store_prodlist.vars.featuredItemsHP.items_per_page=8;myControl.ext.store_prodlist.vars.featuredItemsHP.hide_multipage=true;myControl.ext.store_prodlist.vars.bestSellersHP={};myControl.ext.store_prodlist.vars.bestSellersHP.items_per_page=2;myControl.ext.store_prodlist.vars.bestSellersHP.hide_multipage=true;myControl.ext.store_navcats.calls.appCategoryDetail.init('.',{'targetID':'featuredItemsHP','callback':'showProdList','extension':'myRIA','templateID':'prodHPFeaturedTemplate'});myControl.ext.store_navcats.calls.appCategoryDetail.init('$best_sellers',{'targetID':'bestSellersHP','callback':'showProdList','extension':'myRIA','templateID':'prodHPBestTemplate'});myControl.model.dispatchThis();}
else{$('#globalMessaging').empty().hide();$('#mainContentArea').empty().append(myControl.renderFunctions.transmogrify('page-'+catSafeID,'categoryPageTemplate',{}));myControl.ext.store_navcats.calls.appCategoryDetailMax.init(catSafeID,{"callback":"showPageContent","extension":"myRIA"})
$('#catPageTopContent').replaceWith(myControl.renderFunctions.createTemplateInstance('catPageHeaderTemplate',{'id':'catPageTopContent'}));$('#catPageBottomContent').replaceWith(myControl.renderFunctions.createTemplateInstance('catPageFooterTemplate',{'id':'catPageBottomContent'}));myControl.ext.store_navcats.calls.appPageGet.init({'PATH':catSafeID,'@get':['banner1_link','banner1','description','short_description','youtube_videoid']},{"callback":"translateTemplate","parentID":"catPageTopContent"});myControl.ext.store_navcats.calls.appPageGet.init({'PATH':catSafeID,'@get':['description2']},{"callback":"translateTemplate","parentID":"catPageBottomContent"});myControl.model.dispatchThis();}},showOrderDetails:function(orderID){var safeID=myControl.util.makeSafeHTMLId(orderID);$orderEle=$('#orderContents_'+safeID);if($orderEle.is(':empty')){$orderEle.show().addClass('ui-corner-bottom ui-accordion-content-active');$orderEle.append(myControl.renderFunctions.createTemplateInstance('orderContentsTemplate','orderContentsTable_'+safeID))
$('#orderContentsTable_'+safeID).addClass('loadingBG');if(myControl.ext.store_crm.calls.buyerPurchaseHistoryDetail.init(orderID,{'callback':'showOrder','extension':'store_crm','templateID':'orderContentsTemplate','parentID':'orderContentsTable_'+safeID}))
myControl.model.dispatchThis();$orderEle.siblings().addClass('ui-state-active').removeClass('ui-corner-bottom').find('.ui-icon-triangle-1-e').removeClass('ui-icon-triangle-1-e').addClass('ui-icon-triangle-1-s');}
else{if($orderEle.is(':visible')){$orderEle.removeClass('ui-corner-bottom ui-accordion-content-active').hide();$orderEle.siblings().removeClass('ui-state-active').addClass('ui-corner-bottom').find('.ui-icon-triangle-1-s').removeClass('ui-icon-triangle-1-s').addClass('ui-icon-triangle-1-e')}
else{$orderEle.addClass('ui-corner-bottom ui-accordion-content-active').show();$orderEle.siblings().addClass('ui-state-active').removeClass('ui-corner-bottom').find('.ui-icon-triangle-1-e').removeClass('ui-icon-triangle-1-e').addClass('ui-icon-triangle-1-s')}}},removeByValue:function(arr,val){for(var i=0;i<arr.length;i++){if(arr[i]==val){arr.splice(i,1);break;}}},showCart:function(){myControl.ext.store_cart.util.showCartInModal('cartViewer');if(myControl.ext.store_cart.vars.cartAccessories.length>0){myControl.ext.store_prodlist.util.buildProductList({"templateID":"productTemplate","withInventory":1,"withVariations":1,"parentID":"cartAccessoriesCarousel","csv":myControl.ext.store_cart.vars.cartAccessories});myControl.model.dispatchThis();$('#cartAccessoriesCarouselContainer').show();$('#cartAccessoriesCarousel').jcarousel();}},handleAddToList:function(pid,listID){myControl.util.dump("BEGIN myRIA.util.handleAddToList ("+pid+")");var authState=myControl.sharedCheckoutUtilities.determineAuthentication();if(authState=='authenticated'){myControl.ext.store_crm.calls.addToCustomerList.init({"listid":listID,"sku":pid},{"parentID":"CRMButtonMenu","message":"Item has been added to your list","callback":"showMessaging"});myControl.model.dispatchThis();}
else{myControl.ext.myRIA.util.showLoginModal();$('#loginMessaging').append("This feature requires you to be logged in.");$('#loginSuccessContainer').empty();$('<button>').addClass('stdMargin ui-state-default ui-corner-all  ui-state-active').attr('id','modalLoginContinueButton').text('Continue').click(function(){$('#loginFormForModal').dialog('close');myControl.ext.myRIA.util.handleAddToList(pid,listID);}).appendTo($('#loginSuccessContainer'));}},loginFrmSubmit:function(email,password){var errors='';var $errorDiv=$("#loginMessaging").empty().toggle(false);if(myControl.util.isValidEmail(email)==false){errors+="Please provide a valid email address<br \/>";}
if(!password){errors+="Please provide your password<br \/>";}
if(errors==''){myControl.calls.authentication.zoovy.init({"login":email,"password":password},{'callback':'authenticateZoovyUser','extension':'myRIA'});myControl.calls.refreshCart.init({},'immutable');myControl.model.dispatchThis('immutable');}
else{$errorDiv.toggle(true).append(myControl.util.formatMessage(errors));}},handleAddToCart:function(formID){myControl.util.dump("BEGIN store_product.calls.cartItemsAdd.init")
$('#'+formID+' .atcButton').addClass('disabled').attr('disabled','disabled');if(!formID){}
else{var pid=$('#'+formID+'_product_id').val();if(myControl.ext.store_product.validate.addToCart(pid)){myControl.ext.store_product.calls.cartItemsAdd.init(formID,{'callback':'itemAddedToCart','extension':'myRIA'});myControl.calls.refreshCart.init({'callback':'updateMCLineItems','extension':'myRIA'},'immutable');myControl.model.dispatchThis('immutable');}
else{$('#'+formID+' .atcButton').removeClass('disabled').removeAttr('disabled');}}
return r;}}}
return r;}