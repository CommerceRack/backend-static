<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Ajax and Jquery testing file (for sporks)</title>

<!--

Note from the developer:

The name of the extension is 'simple_sample'. The keyword being 'simple'. 
There are much more elaborate things that can be done.  
This example is meant to be used as a road map to get you started. 
It also uses syntax and coding  styles that we consider  to be best practice.
You are not required to use our MVC to access our API, but are welcome to. 

The framework was designed to be flexible and portable, as much as possible. in some cases,
the flexibility is planned in favor of getting a working sample out now.

the simple_sample.js file has a lot of comments in it. I suggest reading them. humor me.
the model and controller files are also packed full of comments. the extensions themselves too.
we like commented code. speaking of coments, comment your code too. 
best practice is to comment 'why' you are doing something, not 'what' you are doing.
 -> easier said than done, i know.  i tried tho.
 
 
this file is typically referred to as 'the view'. It contains emplates and the basic 'theme' of the app.
it also loads and executes the controller.
-->


<link rel="stylesheet" type="text/css" href="http://static.zoovy.com/graphics/general/jslib/jquery/jqueryui_themes/ui-cupertino-1.8.16/jquery-ui-1.8.16.custom.css" />

<style type='text/css'>

.clearfix:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
}

.mpControlContainer	{clear:both; margin:12px 0;}
.mpControlPages	{float:right; margin:0; padding:0;}
.mpControlPages li	{list-style:none; float:left; margin:0 3px; border:1px solid #cccccc; padding:0px 4px;  cursor:pointer; display:block;}


.mpControls	{display:block; margin-bottom:10px; border:1px solid #cccccc; background:#f0f0f0; padding:5px;}

ul.prodlist	{list-style:none; margin:0; padding:0;}
ul.prodlist li	{list-style:none; float:left; width:150px; margin:10px; height:190px; overflow:hidden; position:relative;}
ul.prodlist li img	{width:150px; height:150px;}
ul.prodlist li button.iconDisplay	{position:absolute; top:130px; right:0px; width:20px; background:#990000; height:20px;}
ul.prodlist li span.plIconList	{position:absolute; top:0; right:0px; width:20px; background:#efefef; height:130px;}

table td	{vertical-align:top;}

#templates	{display:none;}

/* use id's to set a different loadingBG class for elements that are shorter or where you want a slightly different bg */
.loadingBG	{background:url(http://static.zoovy.com/graphics/layouts/checkout-20111031/loading_blue-28x28.gif) no-repeat center center; min-height:28px;}

#subcats	{padding-bottom:24px; clear:both}
#subcats li	{list-style:none; margin:12px; height:200px; width:150px; float:left;}
.catThumb	{width:150px; height:150px;}


.borderNone	{border:none;}
.displayNone	{display:none;}


/*
http://www.1stwebdesigner.com/css/how-to-use-css3-orientation-media-queries/
*/
/* Portrait */
@media screen and (orientation:portrait) {
	#leftCol	{display:none;}
	#mainCol	{width:100%;}
	}
/* Landscape */
@media screen and (orientation:landscape) {
	#leftCol	{display:block; width:25%}
	#mainCol	{width:75%;}
	}



</style>

<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/jquery/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/jquery/jqueryui-1.8.16/js/jquery-ui.min.js"></script>


<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/zmvc/201205/model.js"></script>
<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/zmvc/201205/controller.js"></script>
<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/zmvc/201205/json2.js"></script>
<script type="text/javascript" src="http://static.zoovy.com/graphics/general/jslib/zmvc/201205/variations.js"></script>


<script type="text/javascript" src="http://www.sporktacular.com/jquery/config.js?MVC=20120121073500"></script>




<!--
<script src="//connect.facebook.net/en_US/all.js" type="text/javascript"></script>
-->
<script type="text/javascript">

// !!! full path required for extension filename when viewing on a server. relative path works fine for local.
// http://static.zoovy.com/graphics/general/jslib/zmvc/201205/
var myExtensions = [
	{"namespace":"store_prodlist","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_prodlist.js"},
	{"namespace":"store_navcats","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_navcats.js"},
	{"namespace":"store_search","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_search.js"},
	{"namespace":"store_product","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_product.js"},
//	{"namespace":"convertSessionToOrder","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/checkout_nice.js"},
	{"namespace":"store_cart","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_cart.js"},
	{"namespace":"store_crm","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/store_crm.js"},
	{"namespace":"simple_sample","filename":"http://static.zoovy.com/graphics/general/jslib/zmvc/201205/extensions/simple_sample.js","callback":"startMyProgram"}
	];
	
var myControl;

$(function() {
	$.support.cors = true;  //cross site scripting for non cors sites. will b needed for IE10. IE8 & 9 don't support xss well.
	myControl = new zController({
		"username":"sporks",
		"sdomain":"sporks.zoovy.com",
//		"sessionId" : "WduJqj9Hq43Wk8DV7rRlnUITI",
		"jqurl":"http://sporks.zoovy.com/jquery/", //could be changed to zoovy.com/webapi...
		"release":"20120131095400", //increment this with each change. should solve caching issues.
		"secureURL" : "https://ssl.zoovy.com/s=sporks.zoovy.com/" //will change based on whether or not user has ssl cert. end with a slash.
		},myExtensions);  //instantiate controller. handles all logic and communication between model and view.
	});




</script>




</head>

<body style='padding:10px; font-family:Arial, Helvetica, sans-serif; color:#333333; font-size:11px;'>







<!-- used for any 'global' errors, such as incompatible system settings, high level errors and also for request/response errors. -->
<div id='globalMessaging' class='displayNone'></div>


<!--
some very simple html, used for positioning elements

 -->
<table width='100%'>
<tr>
	<td align='left'>
<form id='headerSearchFrm' name='headerSearchFrm' onSubmit="myControl.ext.store_search.calls.searchResult.init(this,{'callback':'showResults','extension':'simple_sample'}); myControl.model.dispatchThis();  return false;">
<fieldset>
	<legend>keyword search</legend>
	<div class="ui-widget">
	<input type='text' name='KEYWORDS' id='headerKeywordsInput' value='spork' />
	</div>
	<input type='hidden' name='CATALOG' id='headerCatalog' value='DICTIONARY' /><!-- set value to search catalog (uppercase). if none sets, will default to 'primary' of account. -->
	<input type='submit' value='search' /><span id='searchHelp'></span>
</fieldset>
</form>
	</td>
	<td align='right'>
<a href='#' onClick="myControl.ext.store_cart.util.showCartInModal('cartViewer')">View Cart</a><!--	 | <a href='#' onClick='myControl.ext.convertSessionToOrder.calls.startCheckout.init("mainCol");'>Checkout</a> -->
	</td>
</tr>
</table>
<table width='100%'>
<tr>
	<td id='leftCol' width='25%'>
	
	</td>
	<td id='mainCol' width='75%'>

	</td>
</tr>
</table>












<!-- this does not need to be called templates or even be present. here to keep things organized. -->
<div id='templates'>

<!--
the following templates will get added to the myControl.templates object.
to avoid a 'blink' (the templates being visible before they're removed from the dom) put the templates into a hidden div.
What templates are used need to be declared in the extension.
each template should only be declared once.
the default extensions (store_prodlist, store_navcats, etc) do NOT load templates. include any templates you want in your own extension.

avoid using any 'id=' within a template if it is going to be repeated on the page (a product or category template, for instance).

for products, an id is added to the template of parentID_PID and a data-pid='PID' where PID = product id and parentID is a var passed in to the template.

similarly, categories get an id of parentID_catsafeid (with periods removed) and a data-catsafeid='.cat.safe.id'

NOTE - for 'lists', if you don't have a UL or OL around the LI in the view (this file) IE gets upset and duplicates every template twice.
note a huge deal since the OL or UL makes it html compliant.

the format:imageURL will use the height/width of the element to generate an instance of the image at those dimensions.  you can also use a css class to define this.
-->




<!--
used for store_navcats.js
-->


<ul>
<!--a sample category template. -->
	<li id='categoryTemplate' onClick="myControl.ext.simple_sample.util.showPage($(this).attr('data-catsafeid'));">
	<span data-bind='var: category(pretty); format:text;'></span>
	</li>
</ul>

<ul>
<!-- another sample category template. not currently used, but illustrates how to generate a thumbnail. -->
<li id='categoryThumbTemplate'>
	<img class='catThumb' data-bind='var: category(%meta.CAT_THUMB); format:imageURL;'  />
	<div class='catPretty' data-bind='var: category(pretty); format:text;'></div>
</li>
</ul>




<!--
used for store_prodlist.js

-->

<!-- a template for multipage controls -->
<div id='mpControlSpec' class='mpControlContainer'>
	<div class='mpControls'>

		<ul class='mpControlPages floatRight' data-bind='var:prodlistmeta(total_page_count); format:mpPagesAsListItems; extension:store_prodlist;'></ul>

		<span data-bind='var:prodlistmeta(items_on_this_page); format:text; pretext:Showing ;'></span>
		<span data-bind='var:prodlistmeta(total_product_count); format:text; pretext: of ;'></span> Items ( page  
		<span data-bind='var:prodlistmeta(page_in_focus); format:text;'></span> of <span data-bind='var:prodlistmeta(total_page_count); format:text;'></span>: 
		#<span data-bind='var:prodlistmeta(page_start_point); format:text;'></span> - 
		#<span data-bind='var:prodlistmeta(page_end_point); format:text;'></span> )
		
	</div>
</div>



<ul>
<!--
this is a very simple product list template. note that when product template is created, data-pid is typically set.
NOTE - the class loadingBG can be applied to any template (top parent element) and it will be removed once the template is translated.
This is handy in templates being used in 'lists' where it is possible for data to get loaded over a period of time.
-->
<li id='productTemplate' class='loadingBG'>
<!--	<button class='iconDisplay'>Oh</button> -->
	<div onClick="myControl.ext.store_product.util.prodDataInModal({'pid':$(this).parent().attr('data-pid'),'templateID':'prodViewerTemplate'});">
		<img class='prodThumb' data-bind='var: product(zoovy:prod_image1); format:imageURL;' />
		<div class='prodName' data-bind='var: product(zoovy:prod_name); format:text; defaultVar: description;'></div>
		<div data-bind='var: product(zoovy:base_price); format:money; currencySign: $;  hideZero:true;'></div>
		
	</div>
</li>
</ul>






<!--
used for store_cart.js

A cart has two templates. 1 for all the general data (order totals, shipping, gift cards ,etc) and another for 'stuff', which is where 
the line items are contained (each item in the cart).
util.showStuff will update an element with the cart items. that utility would typically be executed in a callback
such as displayCart in the store_cart extension.
the id of the element and it's templateid need to get passed into displayCart. I opted to set these as data- and have them read from there,
rather than passing additional _tags or setting vars.
-->

<div id='cartViewer' class='loadingBG' data-stuffID='cartViewerContents' data-stuffTemplateID='cartViewerProductTemplate'>

<form id='cartViewerForm' action='' onSubmit='return false'>
	<ul id='cartViewerContents'></ul>
	<hr />

	<div id='cartSummaryTotalsSpec'>
		
		<div data-bind="var: cart(id); format:text; pretext:CART ID: ; "></div> <!-- here for testing. you probably wouldn't want this -->
		
		<div data-bind="var: cart(data.order_subtotal); format:money; className:orderSubtotal; hideZero:false; currencySign: $; pretext:Subtotal: ; "></div>
		
		<div data-bind='var: cart(data.tax_total); format:money; className:orderTax; hideZero:true;currencySign: $; pretext:Tax: ; '></div>
		
<!-- !!!
need to decide what to do here. Don't want to duplicate the code.  make store_cart a dependency for checkout?
		<div data-bind='var: cart(ship.selected_id); format:shipInfoById; className:orderShipping; hideZero:false; extension:convertSessionToOrder;'></div>
-->		
		<div data-bind='var: cart(data.order_total); format:money; className:orderTotal; hideZero:false; currencySign: $; pretext:Order Total: ; '></div>
		
		<div data-bind='var: cart(chkout.giftcard_total); format:money; className:orderGiftcardTotal; hideZero:false; currencySign: $; pretext:Giftcard(s): ; '></div>
<!--		
		<div data-bind='var: cart(data.balance_due); format:orderBalance; className:orderBalanceDue; hideZero:false; currencySign: $; pretext:Balance Due: ; extension:convertSessionToOrder;'></div>
-->		
	</div>
</form>
</div>


<!-- cart line-item template -->
<ul>
	<li id='cartViewerProductTemplate'>
		<div class='prodName' data-bind='var: product(prod_name); format:text; defaultVar: description;'></div>
		
		<div class='ztable_row_small stid' data-bind='var: product(sku); format:text; className: stid; pretext: Sku: ;'></div>
		
		<div>
		qty: <input type='number' class='zform_textbox' onChange='myControl.ext.store_cart.util.updateCartQty(this);'  data-bind='var: product(qty); format:cartItemQty;extension:store_cart;' >
		<span data-bind='var: product(price); format:money; currencySign: $;  hideZero:false; pretext: x ;' ></span>
		<span data-bind='var: product(extended); format:money; currencySign: $; hideZero:false; pretext: = ;'></span>
		</div>
		
		<div class='ztable_row_small prodOptions' data-bind='var: variations(*options); format:selectedOptionsDisplay;'></div>
	</li>
</ul>








<!--
used for store_product.js

form - the form id gets modified to be unique in case multiple viewers are open at the same time. _pid is appended to it.
NOTE - currently, variations.js supports only 1 viewer at a time. this will change.
2 fieldsets are present:
 -> One is for variations/options and really ought to be present. 
 -> The other is for a quantity input and is optional

the submit button does not need to be within the form (a button could be used elsewhere if needed. 
 -> use the button to submit the form, not execute the call or utility separately. That way if additional
 actions are added to the submit, they only have to be managed in one place.

note - this is draft 1. currently, the view in modal utility has the reviewsummary and reviews content ID's hard coded.
reviewSummaryID='prodViewerReviewSummary' 
reviewsID='prodViewerReviews'
this will likely become more flexible in the future. ###
-->



<div id='prodViewerTemplate'  >


<table>
<tr>
	<td>
<img class='prodBigImage' data-bind='var: product(zoovy:prod_image1); format:imageURL;' width='300' height='300' />
	</td>
	<td>
	<h2 class='prodName' data-bind='var: product(zoovy:prod_name); format:text; defaultVar: description;'></h2>
	<h6 class='ztable_row_small stid' data-bind='var: product(pid); format:text; className: stid; pretext: Sku: ;'></h6>
	<h3 data-bind='var: product(zoovy:base_price); format:money; currencySign: $;  hideZero:true;'></h3>
	
	
	<form data-bind='var: product(pid); format:atcForm; extension:store_product;' id='prodViewerAddToCartFrm' action='#' onSubmit="myControl.ext.store_product.util.handleAddToCart(this.id);  return false;">
	
		<fieldset data-bind='var: product(pid); format:atcVariations; extension:store_product;' class='borderNone'></fieldset>
		<fieldset data-bind='var: product(pid); format:atcQuantityInput; extension:store_product; pretext:Quantity;' class='borderNone'></fieldset>
	
<!--
you'll likely want to something MUCH more custom here. this just simply adds it to the cart and reports a success. it can be used, if desired. 

-->	
		<input type='submit' value='Add to Cart' data-bind='var: product(pid); format:addToCartButton; extension:store_product;' id='addToCartBtn' class='displayNone' />
	</form>
	
	<section id='prodViewerReviewSummary' data-templateID='prodReviewSummaryTemplate'></section>
	<ul id='prodViewerReviews' data-templateID='prodReviewsTemplate'></ul>

	
	
	</td>
</tr>
</table>
</div>

<!-- review summary template -->

<div id='prodReviewSummaryTemplate'>
Review Summary: <span data-bind='var: reviews(average); format:text; posttext: from ; hidezero:true;'></span><span data-bind='var: reviews(total); format:text;'></span> Reviews
</div>

<!-- individual review template -->
<ul>
	<li id='prodReviewsTemplate'>
	<ul>
		<li data-bind='var:review(CREATED_GMT); format:text; pretext:Created ;'></li>
		<li data-bind='var:review(CUSTOMER_NAME); format:text; pretext:Customer Name ;'></li>
		<li data-bind='var:review(LOCATION); format:text; pretext:Location ;'></li>
		<li data-bind='var:review(MESSAGE); format:text; pretext:Review: ;'></li>
		<li data-bind='var:review(RATINGDECIMAL); format:text; pretext:Rating (decimal) ;'></li>
		<li data-bind='var:review(SUBJECT); format:text; pretext:Subject ;'></li>
	</ul>
	</li>
</ul>

<!-- image viewer template -->
<div id='imageViewerTemplate'>

<table>
<tr>
	<td><img class='prodBigImage' data-bind='var: product(zoovy:prod_image1); format:imageURL;' width='500' height='500' /></td>
	<td>
	<img class='prodThumb' data-bind='var: product(zoovy:prod_image2); format:imageURL;' width='100' height='100' />
	<img class='prodThumb' data-bind='var: product(zoovy:prod_image3); format:imageURL;' width='100' height='100' />
	<img class='prodThumb' data-bind='var: product(zoovy:prod_image4); format:imageURL;' width='100' height='100' />
	<img class='prodThumb' data-bind='var: product(zoovy:prod_image5); format:imageURL;' width='100' height='100' />
	<img class='prodThumb' data-bind='var: product(zoovy:prod_image6); format:imageURL;' width='100' height='100' />
	</td>
</tr>
</table>
</div>








<!--
used for store_crm.js
-->

<div id='reviewFrmTemplate'>

<form name="reviewFrm" id="reviewFrm" action="#" onSubmit="myControl.ext.store_crm.validate.addReview(); return false;">
<input type='hidden' name='pid' id='reviewsPid' value='' data-bind='var: product(pid); format:popVal;' />

<label for='reviewsCustomerName'>Your Name:</label>
<input type="text" name="CUSTOMER_NAME" id='reviewsCustomerName' value="" MAXLENGTH="30" />
<br />

<label for='reviewsLocation'>Location:</label>
<input type="text" MAXLENGTH="30" name="LOCATION" id='reviewsLocation' value="" />
<br />

<label for='reviewsSubject'>Subject:</label>
<input type="text" MAXLENGTH="60" name="SUBJECT" id='reviewsSubject' />
<br />


<label for='reviewsMessage'>Review:</label>
<textarea name="MESSAGE" id='reviewsMessage'></textarea>
<br />

<label for='reviewsRating'>Score:</label>
<select name="RATING" id='reviewsRating'>
	<option value="10">5</option>
	<option value="9">4.5</option>
	<option value="8">4</option>
	<option value="7">3.5</option>
	<option value="6">3</option>
	<option value="5">2.5</option>
	<option value="4">2</option>
	<option value="3">1.5</option>
	<option value="2">1</option>
	<option value="1">.5</option>
</select>
<br />

<input type="submit" value="submit review" />

</form>
</div>


<div id='subscribeFormTemplate'>
<form action='#' id='subscribeFrm' name='subscribeFrm' onSubmit="myControl.ext.store_crm.util.handleSubscribe(this.id); return false">

<input type='email' class='zform_textbox' maxlength='50' name='login' id='subscribeLogin' value='email address' />
<input type='text' class='zform_textbox' maxlength='50' name='fullname' id='subscribeFullname' value='Full name' />
<fieldset data-bind="var:newsletters(@lists); format:subscribeCheckboxes; extension:store_crm;" class='borderNone'></fieldset>
<input type='submit' class='zform_button' value='Subscribe'>

</form>
</div>





<!-- used by simple_sample.js -->

<div id='pageTemplate'>
	
	<section id='subcats' class='clearfix'></section>
	<section id='prodlist' class='clearfix'></section>
	
</div>



</div><!-- /templates -->














<hr />

<button onClick="console.dir(myControl.q);">Qs to console</button>
<button onClick="console.dir(myControl.data);">myControl.data</button> 
<button onClick="myControl.ext.store_crm.util.showSubscribe({'parentID':'leftCol','templateID':'subscribeFormTemplate'}); myControl.model.dispatchThis();">getNewsletters</button>
<button onClick="myControl.ext.store_crm.calls.tellAFriend.init('outfit',{'parentID':'leftCol'}); myControl.model.dispatchThis();">tellAFriend</button>
<button onClick='localStorage.clear()'>Nuke local storage</button>


</body>
</html>
